<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bijoliya Stones - Rajasthan SandStone Hub</title>
<link rel="icon" href="stone-icon.png" type="image/png">
<link rel="stylesheet" href="style.css">
<style>
body {
  font-family: "Poppins", sans-serif;
  background: #f5f5f5;
  margin: 0;
}

/* Header */
header {
  background: #c7a97b;
  color: white;
  padding: 15px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
}
header h1 {
  font-size: 1.5rem;
  cursor: pointer;
  margin: 0;
}
header div {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}
header button {
  padding: 8px 15px;
  border: none;
  background: #fff;
  color: #c7a97b;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
}

/* Navigation */
nav {
  display: flex;
  justify-content: center;
  gap: 15px;
  background: #f3f3f3;
  padding: 10px;
  flex-wrap: wrap;
}
nav a {
  text-decoration: none;
  color: #333;
  font-weight: 600;
}

/* Container */
.container {
  padding: 20px;
  max-width: 1200px;
  margin: auto;
}
h2 {
  color: #444;
  text-align: center;
  margin-bottom: 20px;
}

/* Product Grid */
#product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 20px;
}
.card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  padding: 10px;
  transition: transform 0.2s ease;
}
.card:hover { transform: scale(1.02); }
.card img {
  width: 100%;
  height: 160px;
  object-fit: cover;
  border-radius: 6px;
}
.card h3 { margin: 10px 0 5px; color: #333; }
.card p { margin: 3px 0; font-size: 0.9rem; color: #555; }

footer {
  background: #333; color: white; text-align: center; padding: 15px; margin-top: 40px;
}
footer a { color: white; text-decoration: none; }
</style>
</head>
<body>

<header>
  <h1 onclick="window.location='index.html'">ðŸª¨ Rajasthan SandStone Hub</h1>
  <div>
    <button onclick="window.location='index.html'">Home</button>
    <button onclick="window.location='history.html'">My History</button>
    <button id="logout-btn">Logout</button>
  </div>
</header>

<nav>
  <a href="bijoliya.html">Bijoliya</a>
  <a href="dholpur.html">Dholpur</a>
  <a href="mandana.html">Mandana</a>
  <a href="kota.html">Kota</a>
  <a href="other-stones.html">Other Stones</a>
  <a href="factories.html">Factories</a>
  <a href="about.html">About Us</a>
  <a href="contact.html">Contact</a>
</nav>

<div class="container">
  <h2>Bijoliya Stone Products</h2>
  <div id="product-grid"></div>
  <p id="no-products" style="text-align:center;color:#666;display:none;">No Bijoliya products found.</p>
</div>

<footer>
  &copy; 2025 Rajasthan SandStone Hub | Designed by RJ Services |
  <a href="about.html">About Us</a> | <a href="contact.html">Contact</a>
</footer>

<script type="module">
import { 
  auth, db, collection, getDocs, query, where, orderBy, signOut 
} from "./firebase-config.js";

const logoutBtn = document.getElementById("logout-btn");
const grid = document.getElementById("product-grid");
const noProducts = document.getElementById("no-products");

logoutBtn.onclick = async () => {
  await signOut(auth);
  window.location = "signin.html";
};

// âœ… User check
auth.onAuthStateChanged(async (user) => {
  if (!user) {
    window.location = "signin.html";
    return;
  }
  loadProducts();
});

async function loadProducts() {
  grid.innerHTML = "<p style='text-align:center;'>Loading...</p>";
  
  // Firestore Query - Only Bijoliya products
  const q = query(
    collection(db, "products"),
    where("category", "==", "Bijoliya"),
    orderBy("created_at", "desc")
  );

  const snap = await getDocs(q);
  grid.innerHTML = "";
  if (snap.empty) {
    noProducts.style.display = "block";
    return;
  }

  snap.forEach((doc) => {
    const d = doc.data();
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <img src="${d.image}" alt="${d.stone_name}">
      <h3>${d.stone_name}</h3>
      <p><b>Category:</b> ${d.category}</p>
      <p><b>Type:</b> ${d.type}</p>
      <p><b>Color:</b> ${d.color}</p>
      <p><b>Price:</b> â‚¹${d.price} / ${d.price_unit}</p>
      <p><b>Factory:</b> ${d.factory_name}</p>
      <div style="display:flex;justify-content:space-between;margin-top:10px;">
        <a href="https://wa.me/${d.contact_number}" target="_blank" style="color:#25D366;">WhatsApp</a>
        <a href="tel:${d.contact_number}" style="color:#007bff;">Call</a>
      </div>
    `;
    grid.appendChild(card);
  });
}
</script>
</body>
</html>
