<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Post Product | Rajasthan SandStone Hub</title>
<link rel="icon" href="stone-icon.png" type="image/png">
<link rel="stylesheet" href="style.css">

<style>
/* ===== Header & Theme same as Home Page ===== */
body{font-family:sans-serif;margin:0;padding:0;background:#fafafa;}
header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,0.1);}
header h1{color:#c7a97b;cursor:pointer;}
header input{padding:8px;width:200px;border-radius:6px;border:1px solid #ccc;}
header button{background:#c7a97b;color:white;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;}
header button:hover{background:#b38c5f;}
nav{display:flex;justify-content:center;gap:15px;background:#f3f3f3;padding:10px;}
nav a{text-decoration:none;color:#333;font-weight:600;}
.banner{background:#c7a97b;color:white;text-align:center;padding:40px;font-size:1.4rem;margin-bottom:20px;}
footer{background:#333;color:white;text-align:center;padding:15px;margin-top:20px;}

/* ===== Admin Form ===== */
section{max-width:700px;margin:20px auto;background:white;padding:25px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.1);}
section h2{text-align:center;color:#c7a97b;margin-bottom:20px;}
form input, form select, form textarea{
  width:100%;padding:10px;margin-bottom:12px;
  border:1px solid #ccc;border-radius:6px;font-size:1rem;
}
form button{
  width:100%;padding:12px;background:#c7a97b;color:white;
  border:none;border-radius:6px;font-weight:600;cursor:pointer;
}
form button:hover{background:#b38c5f;}
.feedback{text-align:center;margin-top:10px;font-weight:600;}
</style>
</head>
<body>

<!-- ===== Header ===== -->
<header>
  <h1 onclick="window.location='index.html'">ü™® Rajasthan SandStone Hub</h1>
  <div>
    <button onclick="window.location='index.html'">üè† Home</button>
    <button id="btn-signout">Sign Out</button>
  </div>
</header>

<!-- ===== Navigation ===== -->
<nav>
  <a href="bijoliya.html">Bijoliya Stone</a>
  <a href="dholpur.html">Dholpur Stone</a>
  <a href="mandana.html">Mandana Stone</a>
  <a href="kota.html">Kota Stone</a>
  <a href="other-stones.html">Other Stones</a>
  <a href="factories.html">Factories</a>
</nav>

<!-- ===== Banner ===== -->
<div class="banner">Add Your Stone Product Listing</div>

<!-- ===== Product Form ===== -->
<section>
  <h2>üß± Post New Stone Product</h2>
  <form id="product-form">
    <input type="text" id="stone_name" placeholder="Stone Name" required>
    <input type="text" id="factory_name" placeholder="Factory / Company Name" required>
    <input type="text" id="category" placeholder="Category (e.g., Bijoliya, Dholpur)" required>
    <input type="text" id="sub_category" placeholder="Sub Category (e.g., Farsi, Slab, Tile)">
    <input type="text" id="type" placeholder="Type (e.g., Natural, Polished)">
    <input type="text" id="color" placeholder="Color (e.g., Brown, Red)">
    <input type="number" id="price" placeholder="Price">
    <input type="text" id="price_unit" placeholder="Unit (e.g., sq.ft, piece)">
    <textarea id="description" placeholder="Short Description"></textarea>
    <input type="text" id="image" placeholder="Image URL (paste image link)" required>
    <input type="text" id="whatsapp_link" placeholder="WhatsApp Link (https://wa.me/91...)">
    <input type="text" id="contact_number" placeholder="Contact Number (+91...)">
    <button type="submit">Submit Product</button>
    <div class="feedback" id="feedback"></div>
  </form>
</section>

<!-- ===== Footer ===== -->
<footer>
  &copy; 2025 Rajasthan SandStone Hub | Managed by RJ Services
</footer>

<!-- ===== Scripts ===== -->
<script type="module">
import { db, auth } from './firebase-config.js';
import { collection, addDoc, serverTimestamp } 
  from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";
import { signOut, onAuthStateChanged } 
  from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

/* ===== Sign Out ===== */
const btnSignOut = document.getElementById('btn-signout');
btnSignOut.addEventListener('click', async ()=>{
  await signOut(auth);
  alert('Signed out successfully!');
  window.location='index.html';
});

/* ===== Auth Guard ===== */
onAuthStateChanged(auth, user=>{
  if(!user){
    alert('Please sign in first!');
    window.location='index.html';
  }
});

/* ===== Form Submit ===== */
const form = document.getElementById('product-form');
const feedback = document.getElementById('feedback');

form.addEventListener('submit', async(e)=>{
  e.preventDefault();
  feedback.textContent='‚è≥ Uploading...';

  const data = {
    stone_name: form.stone_name.value.trim(),
    factory_name: form.factory_name.value.trim(),
    category: form.category.value.trim(),
    sub_category: form.sub_category.value.trim(),
    type: form.type.value.trim(),
    color: form.color.value.trim(),
    price: parseFloat(form.price.value) || 0,
    price_unit: form.price_unit.value.trim(),
    description: form.description.value.trim(),
    image: form.image.value.trim(),
    whatsapp_link: form.whatsapp_link.value.trim(),
    contact_number: form.contact_number.value.trim(),
    created_at: new Date().toISOString(),
    user_email: auth.currentUser?.email || "guest"
  };

  try {
    await addDoc(collection(db, "products"), data);
    feedback.style.color='green';
    feedback.textContent='‚úÖ Product added successfully!';
    form.reset();
  } catch(err){
    feedback.style.color='red';
    feedback.textContent='‚ùå Error: '+err.message;
  }
});
</script>

</body>
</html>
